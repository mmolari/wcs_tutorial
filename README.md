# PanGraph - a simple hands-on tutorial

This repository contains code for a tutorial of [PanGraph](https://github.com/neherlab/pangraph), in which pangenome graphs are used to study properties of a dataset of _E.coli_ ST131 isolates downloaded from RefSeq.

The tutorial was prepared in occasion of the [Applied Bioinformatics & Public Health Microbiology](https://coursesandconferences.wellcomeconnectingscience.org/event/applied-bioinformatics-public-health-microbiology-20230503/) conference.

## setup

The tutorial can be executed using `snakemake`. Running the code requires:
- a working `conda` and `mamba` installation
- `snakemake`
- having the `pangraph` binary available in your path

All the files can then be generated by running:
```bash
snakemake --profile local all
```

## the dataset

The dataset consists in chromosome sequences of _E.coli_ ST131 isolates present in RefSeq. Their accession numbers are stored in the [`config/strains.txt`](config/strains.txt) file.

These are downladed by the `download_gbk` rule of the snakemake workflow, and placed in the `data/ST131_gbk` subfolder. They longest contig is then extracted and saved in a fasta file in `data/ST131_fa` (`gbk_to_fa` rule of the workflow).

## analysis overview

The analysis is divided in three parts:

- [part 1](notes/part_1.md): examining the structural diversity around bla CTX-M-15 genes.
- [part 2](notes/part_2.md): building a pangenome graph for a part of the dataset and looking at difference in private sequence compared to core genome divergence.
- [part 3](notes/part_3.md): marginalizing the graph on a pair of isolates and visualizing the pairwise projection.

Each part has a corresponding set of notes in the `notes` folder.
